
ï»¿
(function($){$.csvDefaults={separator:',',delimiter:'"',skip:0,headerLine:1,dataLine:2};$.csvEntry2Array=function(csv,meta){var meta=(meta!==undefined?meta:{});var separator='separator'in meta?meta.separator:$.csvDefaults.separator;var delimiter='delimiter'in meta?meta.delimiter:$.csvDefaults.delimiter;var reValid=/^\s*(?:D[^D\\]*(?:\\[\S\s][^D\\]*)*D|[^SD\s\\]*(?:\s+[^SD\s\\]+)*)\s*(?:S\s*(?:D[^D\\]*(?:\\[\S\s][^D\\]*)*D|[^SD\s\\]*(?:\s+[^SD\s\\]+)*)\s*)*$/;reValid=RegExp(reValid.source.replace(/S/g,separator));reValid=RegExp(reValid.source.replace(/D/g,delimiter));var reValue=/(?!\s*$)\s*(?:D([^D\\]*(?:\\[\S\s][^D\\]*)*)D|([^SD\s\\]*(?:\s+[^SD\s\\]+)*))\s*(?:S|$)/g;reValue=RegExp(reValue.source.replace(/S/g,separator),'g');reValue=RegExp(reValue.source.replace(/D/g,delimiter),'g');if(!reValid.test(csv)){return null;}
var output=[];csv.replace(reValue,function(m0,m1,m2){if(m1!==undefined){var reDelimiterUnescape=/\\D/g;reDelimiterUnescape=RegExp(reDelimiterUnescape.source.replace(/D/,delimiter),'g');output.push(m1.replace(reDelimiterUnescape,delimiter));}else if(m2!==undefined){output.push(m2);}
return'';});var reEmptyLast=/S\s*$/;reEmptyLast=RegExp(reEmptyLast.source.replace(/S/,separator));if(reEmptyLast.test(csv)){output.push('');}
return output;};$.array2CSVEntry=function(array,meta){var meta=(meta!==undefined?meta:{});var separator='separator'in meta?meta.separator:$.csvDefaults.separator;var delimiter='delimiter'in meta?meta.delimiter:$.csvDefaults.delimiter;var output=[]
for(i in array){output.push(array[i]);}
return output;};$.csv2Array=function(csv,meta){var meta=(meta!==undefined?meta:{});var separator='separator'in meta?meta.separator:$.csvDefaults.separator;var delimiter='delimiter'in meta?meta.delimiter:$.csvDefaults.delimiter;var skip='skip'in meta?meta.skip:$.csvDefaults.skip;var lines=csv.split(/\r\n|\r|\n/g);var output=[];for(var i in lines){if(i<skip){continue;}
var line=$.csvEntry2Array(lines[i],{delimiter:delimiter,separator:separator});output.push(line);}
return output;};$.csv2Dictionary=function(csv,meta){var meta=(meta!==undefined?meta:{});var separator='separator'in meta?meta.separator:$.csvDefaults.separator;var delimiter='delimiter'in meta?meta.delimiter:$.csvDefaults.delimiter;var headerLine='headerLine'in meta?meta.headerLine:$.csvDefaults.headerLine;var dataLine='dataLine'in meta?meta.dataLine:$.csvDefaults.dataLine;var lines=csv.split(/\r\n|\r|\n/g);var headers=$.csvEntry2Array(lines[(headerLine-1)]);var output=[];for(var i in lines){if(i<(dataLine-1)){continue;}
var line=$.csvEntry2Array(lines[i],{delimiter:delimiter,separator:separator});var lineDict={};for(var j in headers){lineDict[headers[j]]=line[j];}
output.push(lineDict);}
return output;};})(jQuery);